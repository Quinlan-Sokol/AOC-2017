/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package adventofcode;

import java.util.ArrayList;

/**
 *
 * @author QDS
 */
public class Day19 {
    public static void main(String args[]){
        int NORTH = 1;
        int SOUTH = 2;
        int WEST = 3;
        int EAST = 4;
        
        /*String[] lines = {
"     |          ",
"     |  +--+    ",
"     A  |  C    ",
" F---|----E|--+ ",
"     |  |  |  D ",
"     +B-+  +--+ "};*/
        
        String[] lines = {"                                                                                                                                                                   |                                     ",
"                       +---------------------------------------------------------------------------+             +---------------------+             +---+       +-------------------------------------+ ",
"                       |                                                                           |             |                     |             |   |       | |                                   | ",
"                     +---------------+                     +---------------+               +-------|-------------------------------------+           |   |       | |         +-----------+       +-----+ ",
"                     | |             |                     |               |               |       |             |                     | |           |   |       | |         |           |       |       ",
"         +---+       | | +-------+   |                     | +-----------------------------|-------------------------------------------|-----------+ |   |       | |         |           | +-----------+ ",
"         |   |       | | |       |   |                     | |             |               |       |             |                     | |         | |   |       | |         |           | |     |     | ",
" +-----------+       | +-|-----------|-----------+         | +---+         |               |       |           +-----------------------|-|---------------|-------|-----------|-----------------------+ | ",
" |       |           |   |       |   |           |         |     |         |               |       |           | |                     | |         | M   |       | |         |           | |     |   | | ",
" |       |           | +-|-----------|---------------------|-----+         |               |       |           | |           +---------+ +-+     +---------------|-----------|---------------+   | +-+ | ",
" |       |           | | |       |   |           |         |               |               |       |           | |           |             |     | | |   |       | |         |           | | |   | |   | ",
" |       |           | | |       +-------------------------|---------------|---------------|-------|-------+   | |     +-----+         +-----+   | | |   |       | |         | +---+ +-+ | | |   | |   | ",
" |       |           | | |           |           |         |               |               |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | | |   | |   | ",
" |       |           +---|-+         |   +---+   |         +---------------------------------------|-------------|---------------------------|-----|-|---|-------|---------------------|-|-|---------+ | ",
" |       |             | | |         |   |   |   |                         |               |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | | |   | | | | ",
" |       |   +---+     | | |         |   |   |   |                         |       +-------|-------|-------|---|-|-----|---------------|-----------|-------------|-|-----------|---|-|-|-|---+   | | | | ",
" |       |   |   |     | | |         |   |   |   |                         |       |       |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | |     | | | | ",
" |       |   |   |     | | |         |   |   |   |                         |       +-----------------------------|---------------------|---|-|-------------------|-|-----------|---|-|-|-|-------|-|---+ ",
" |       |   |   |     C | |         |   |   |   |                         |               |       |       |   | |     |               |   | |   | | |   |       | |         | |   | | | | |     | | |   ",
" |       | +-|---|-----|-|-----------|-------|-----------------------------|-------------+ |       |       |   | |     |     +-------------|-|---|-|-|---|---+   | |         | |   | | | | |     | | |   ",
" |       | | |   |     | | |         |   |   |   |                         |             | |       |       |   | |     |     |         |   | |   | | |   |   |   | |         | |   | | | | |     | | |   ",
" |       | +-|---|-----|-------------|-------|-----------------------------|---------------|-------------------|-------|-----|---------|---|-+   | | |   |   |   | |         | | +-|---|---|-----|-+ |   ",
" |       |   |   |     | | |         |   |   |   |                         |             | |       |       |   | |     |     |         |   |     | | |   |   |   | |         | | | | | | | |     |   |   ",
" | +---+ |   |   |     | | |         |   | +-+   |                   +---------------------|---+   |       |   | |     |     |         | +-|-----|-|-------------|-----------+ | | | | | | |     | +---+ ",
" | |   | |   |   |     | | |         |   | |     |                   |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | P | ",
" | |   | |   |   |     | | |         |   | |     |           +-+     |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | | ",
" | |   | |   |   |     | | |         |   | |     |           | |     |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | | ",
" | |   | |   |   | +---|-+ |         +---|-|-----|-----------|-+     |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | | ",
" | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     |     |         | | |     | | |   |   |   | |           | | | | | | |     | | | | ",
" | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | +---|---------+ | | +---|-|-|---|---------|-----------|-+ +-+ | | |     | | | | ",
" | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | |   |           | | |   | | |   |   |   | |           |       | | |     | | | | ",
" | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | |   +-------+   | | |   | | |   |   |   | |         +-------+ | | |     | | | | ",
" | |   | |   |   | |   |   |             | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | | | |     | | | | ",
" | | +---|---|---|---------|-----+ +-----|-|-----|-------------------|-----|-------------|-|-------|-----------|-|-----|-------------------|-------|---------|---|-----------|-----------+ |     | | | | ",
" | | | | |   |   | |   |   |     | |     | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | |   |     | | | | ",
" | | | | |   |   | |   |   |     | |     | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | | +-------+ | | | ",
" | | | | |   |   | |   |   |     | |     | |     |           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |         | |     | | | |       | | | ",
" | | | | |   |   | |   |   |     | |     | | +---+           |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |       +-|-+ Y +-|-|-----+     | | | ",
" | | | | |   |   | |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |           |   | | |   | | |   |   |   | |       | |   | | | | | | |     | | | ",
" | | | | |   |   | |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |       +-+ |   | | |   | | |   |   |   | |       | |   | | | | | | |     | | | ",
" | | | | |   |   | |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |       | | |   | | |   | | |   |   |   | |       | |   | | | | | | |     | | | ",
" | | | | |   |   +-|-------|-----|-|-----|-------------------|-------------|---------------|---------------------|-----|-|---------|-|---|-|-|-------|---|-------+ |       | |   | | | | | | |     | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |     |             | |   |   |       |   | |     | |       | | |   | | |   | | |   |   |     |       | |   | | | | | | |     | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |     |       +-----|---------|-------------|---------------|---|---|-|-|-----|-+   |   |     +-------|-+   +---|---|-------+ | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |     |       |     | |   |   |       |   | |     | |       | | |   | | |   | |     |   |             |       | | | | | |   | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |     |       |     | +-------------------|-------|-------------|---+ | |   | |     |   |             |       | | | | | |   | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |     |       |     |     |   |       |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   +-|-------------------|---|-----+ |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | |       |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | |       |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | |       |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | |   | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | | +-----|-----|---------|-------|---|-|-------------------|---------------------------------------------|-|-----|---+ | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |     |   |             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   +-|-+ |             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               |       |   | | |     |     |     |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               | +-----|---|-|-|-----|-----|-+   |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               | |     |   | | |     |     | |   |   |     | |   | |     | |       | | |     | |   | |   | | | |             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               | |   +-------|-|-----|-----|-+   |   | +---+ |   +---------|-------|---------|-|---|-----|-|-|-+             |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |     | | |               | |   | |   | | |     |     |     |   | |     |     |     | |       | | |     | |   | |   | | |               |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   +---|-|---------------|-|---|-|-----|-------------|-+   |   | |     +-----------|-------------|---------+ | |   | | |       +-----+ |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   | | | |               | |   | |   | | |     |     | |   |   | |           |     | |       | | |     | | | | |   | | |       |     | |       | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   | | | |               | |   | |   | | |     |     | |   |   | |   +-------|---------------------------|---|-------|---+     +-------|---+   | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   | | | |               | |   | |   | | |     |     | |   |   | |   |       |     | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   +-+ | |               | |   | |   | | |     |     | |   |   | |   |       |     | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |       | |               | |   | |   | | |     |     | |   |   | |   |       |     | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   +-----|---------------|-|-----------|-|-----|-----|-|---|---|-----------------+ | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   |   | |               | |   | |   | | |     |     | Q   |   | |   |       |   | | |       | | |     | | | | |   | | | |           | |   |   | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   |   | |               | |   | |   | | |     |     | |   |   | |   |       |   | +-----+   | | |     | | | | |   | +-+ |           | |   |   | | | | | | | | | | | ",
" | | | | |   |     |   |   |     | |   |   | |               | |   | |   | | |     |     | |   |   | |   |       |   |   |   |   | | |     | | | | |   |     |           | |   |   | | | | | | | | | | | ",
" | | | +-----------|---|---------|-|-----------------------+ | |   | |   | | |     |     | |   |   | |   |       |   | +---------------------|-|-|-----------|----------E------+   | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | |     |     | |   |   | |   |       |   | | |   |   | | |     | | | | |   |     |           | |       | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | |     |     +---------|-|---|-----------|-|-|---+   | | |     | | | | |   |     |           | |       | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | |     |       |   |   | |   |       |   | | |       | | |     | | | | |   |     |           | |       | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | | +---|-------|---|-+ | | +-|-------------|-|-----------|-----|---|-----+ |     |           +-+       | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |             | | |   | |   | | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |                     | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |   +-----------------|-|---|-----|-----------|---|-|---------------|-----|-------------------|-|-|-----|---------------+             | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |   |         | | |   | |   | | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |             | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |   |         | | |   | |   +---|-|---|-------|---|-----|---|-----------|---------------|-----|-------|---|-----|-----------------+   | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |   |         | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |   +-------+ | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | | | | | ",
" | | |   |   |     |   |   |     | |   |   | |           | | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | | | | | ",
" | | |   |   |     |   +---------------|-+ | |         +-|-|-------------------|-----------|-----|-|-|-|---------------|-|-----------|-----|-|-|---------------------|-------------|-|-|-|-----|-|-+ | | ",
" | | |   |   |     |       |     | |   | | | |         | | | | |   | |     | | |   |       |   | | | | | |       |   | | |       | | |     | | | | | | |     |       |         |   | | | | | | | |   | | ",
" | | |   |   |   +-|---+   |     | |   | | | |         | | | | |   | |     | +-|---|-----+ |   +---|---|-|---+   |   | | +-------|-|-------|---|-|---|-------|-----+ |       +-------|-----+ | | |   | | ",
" | | |   |   |   | |   |   |     | |   | | | |         | | | | |   | |     |   |   |     | |     | | | | |   |   |   | |         | | |     | | | | | | |     |     | |       | |   | | | |   | | |   | | ",
" | | +-+ |   |   | |   |   |     | |   | | +-----------|-|-|---|---|-------|---|---|---------------|-|-|---------+   | |       +-|---|---------|-|-----------|-------|-------|-----|-----|-----|---+ | | ",
" | |   | |   |   | |   |   |     | |   | |   |         | | | | |   | |     |   |   |     | |     | | | | |   |       | |       | | | |     | | | | | | |     |     | |       | |   | | | |   | | | | | | ",
" | |   | |   |   | |   |   |     | |   | |   |         | | | | |   | |     |   |   |     | |     | | | | |   |       | |       | | | |     | | | | | | |     |     | |       | |   | | +-------|-|-+ | | ",
" | |   | |   |   | |   |   |     | |   | |   |         | | | | |   | |     |   H   |     | |     | | | | |   |       | |       | | | |     | | | | | | |     |     | |       | |   | |   |   | | |   | | ",
" | |   | | +-|---|-----+   |     | |   | |   |         | | | | |   | |     |   |   |     +-|-------|---|-|-----------|-----------|-|---+   | | | | | | |     |     | |       | |   | |   |   | | |   | | ",
" | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   |       | |       | | | | |   | | | | | | |     |     | |       | |   | |   |   | | |   | | ",
" | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | +-----|-|-------|-|-----|---|-----|-------------------|-------|-+   | |   |   | | |   | | ",
" | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |     | |       |     | |   |   | | |   | | ",
" | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |     +-|-----+ |     | |   |   | | |   | | ",
" | |   | | | |   | |       |     | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | |     | |   |   | | |   | | ",
" | |   | | | |   | |       | +---|-|---|-|---|-----------|---|-----|-|---------|---|-------------|-|-----|-----|-------|-------|-------|---|---|-|-|-|-----------------------------------|-------------+ ",
" | |   | | | |   | |       | |   | |   | |   |         | | | | |   | |     |   |   |       |     | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | |     | |   |   | | |   |   ",
" | |   | | | |   | |       | |   | |   | |   |         | | | | |   | |     |   | +-|-------|---+ | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | | +-----|-+ |   | | |   |   ",
" | |   | | | |   | |       | |   | |   | |   |         | | | | |   | |     |   | | |       |   | | | | | |   | |     | |       | | | | |   | | | | | | |     |       |     | | |   | | | |   | | |   |   ",
" | |   | | | |   | | +-------|---|-------|---------------|-|---------|-----|---|-----------|---|-|-|-|-----------------------------|-------|-|---------+     |       |     | | |   | | | |   | | |   |   ",
" | |   | | | |   | | |     | |   | |   | |   |         | | | | |   | |     |   | | |       |   | | | | | |   | |     | |       | | | | |   | | | | | |       |       |     | | |   | | | |   | | |   |   ",
" | |   | | | |   | | |     | +-+ | |   | |   |     +---|-----|-----------------|-|-------+ |   | | | | | | +-|-------+ |       | | | | |   | | | | | |       |       |     | | |   | | | |   | | |   |   ",
" | |   | | | |   | | |     |   | | |   | |   |     |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |       | | | | |   | | | | | |       |       |     | | |   | | | |   | | |   |   ",
" | |   | | | |   | | |     |   | | |   | |   |     |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |       +---|---|-------|-|---|-----------------+   | | |   | +---+   | | |   |   ",
" | |   | | | |   | | |     |   | | |   | |   |     |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |         | | | |   | | | | | |       |       | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | | |   | |   | +-------|-|-|-|-------|---------|-|-------------|-|---|-|-----|-|-------------------|-------|-|-------|-------------+ | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | | |   | |   | |   |   | | | | |   | |     |   | | |     | |   | | | | | | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | | +-----+   | |   |   | | | | |   | |     |   | +---------|-----+ | +-+ | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |     |     | |   |   | | | | |   | |     |   |   |     | |   |   |     | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   +-|-----------|---|-|---|-------+ +-------|-----------+   |   |     | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |     |   |     | | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |     | +-|-----+ | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |     | | |       | | |       |         | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |   +---|-|---------|-|---------------+ | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   | |     | |   |   | | | | |   |   |   |   |   |     |   | | | |       | | |       |       | | | | |   | | | | | |       |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   | | +---|---------|---|---------------|---|---|-----|---------|-------|---------------------|---|-------|-|-|-----+     |     | | |   | | |   |   |     | | |   |   ",
" | |   | | | |   | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   | | | |       | | |       |       | | | | |   | | | | | | |     |     | | |   | | |   |   |     | | |   |   ",
" | |   | | +-|-+ | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   | +-|---------|-------------------|-----------|---|-----|-------|-----|---------|-+   |   |     | | |   |   ",
" | |   | |   | | | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   |   | |       | | |       |       | | | | |   | | | | | | |     |     | | |   | |     |   |     | | |   |   ",
" | |   | |   | | | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   |   | |       | | |       |       | | | | |   | | | | | | |     |   +-----|-----+     |   |     | | |   |   ",
" | |   | |   | | | | |     |   | |   | | |   | |   |   | | | | |   |   |   |   |   |     |   |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |     | | |   |   ",
" | |   +-|---|-|---|-|-----|---|-|---|-|-+ +---|-+ |   | | | | |   |   +-------|-----+   |   |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |     | | |   |   ",
" | |     |   | | | | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |   |   |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |     | | |   |   ",
" | | +---+   | | | | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |   +---|-----|-------|-|-----------------|-|-|-|-|---|-|---|-|-|-|-------------------|-------|---|-----+ | |   |   ",
" | | |       | | | | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |       | |   |   ",
" | | | +-----|---+ | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |       | |   |   ",
" | | | |     | |   | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | |       | | |       |       | | | | |   | | | | | | |     |   | | | |   |       |   |       | |   |   ",
" | | | |     | |   | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | | +-------|---------|-------|-|-|-------|-----|-|-|-|---------|-----|-----+     |   |       | |   |   ",
" | | | |     | |   | |     |   | |   | |   | | | | |   | | | | |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   |       | |   |   ",
" | | | |     | |   | |     |   | |   | |   | | | | | +-|-+ | +-------------|---|---|---------|-------------|-|---------|-------|---|-|-|-------|-|-|---------|-------|-|---|-----------|-----+ | |   |   ",
" | | | |     | |   | |     |   | |   | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   |     | | |   |   ",
" | | | | +-----|-----|---------|-+   | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | +-----+ |   |   ",
" | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | |   |   |   |   ",
" | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | |   |   |   |   ",
" | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   | | |     | | |       |       | | | | |   | | | | | | |     |   | | | |   | |     |   | |   |   |   |   ",
" | | | | |   | |   | |     |   |     | |   | | | | | | +-------|-----------|-------|-|-------|-----+ |     | | |       |       +---|-|-|---|-|-|-+ | | |     |   | | | |   | |     |   | |   |   |   |   ",
" | | | | |   | |   | |     |   |     S |   | | | | | |     |   |   |       |   |   | |       |   |   |     | | |       |         | | | |   | | |   | | |     |   | | | |   | |     |   | |   |   |   |   ",
" | | | | |   | |   | |     |   |     | |   | | | | | | +---|-------|---------------------------------|---------|-----------------|---|-|---|-|---+ | | |   +---------|-----|---------+ | |   |   | +-|-+ ",
" | | | | |   | |   | |     |   |     | |   | | | | | | |   |   |   |       |   |   | |       |   |   |     | | |       |         | | | |   | | | | | | |   | |   | | | |   | |     | | | |   |   | | | | ",
" +-----|-|---|-|---|-----------|-----|-|---|-----|---------|---+   |       |   |   | |   +-------|-+ |     | | |       |         | | | |   | | | | | | |   | |   | | | |   | |     | | | |   |   | | | | ",
"   | | | |   | |   | |     |   |     | |   | | | | | | |   |       |       |   |   | |   |   |   | | |     | | |       |         | | | |   | | | | | | |   | |   | | | |   | |     | | | |   |   | | | | ",
"   | | | |   | | +---|-----|---------|-----|---|-|-|-|-----|-------|-------|---|-----|-------+ +-|-|-------|-|---------------------|-|-|-------------------|-|-+ | | +-|---+ |     | | | |   |   | | | | ",
"   | | | |   | | | | |     |   |     | |   | | | | | | |   |       |       |   |   | |   |     | | | |     | | |       |         | | | |   | | | | | | |   | | | | |   |     |     | | | |   |   | | | | ",
" +-------------|-|-|-|-----|---------|-----|-|-----|-|---------------------|---|-----|---------|-|-|-|-------|---------+         | | | |   | | | | | | |   | | | | |   |     |     | | | |   |   | | | | ",
" | | | | |   | | | | |     |   |     | |   | | | | | | |   |       |       |   |   | |   |     | | | |     | | |                 | | | |   | | | | | | |   | | | | |   |     |     | | | |   |   | | | | ",
" | | +-|-----|-|---|-|-----|---------------|---|---|---|---|-------|-------|-------|-----+     | | | |     | | |                 | | | |   | | +---|-+ |   | | | | |   |     |     | | | |   | +-+ | | | ",
" | |   | |   | | | | |     |   |     | |   | | | | | | |   |       |       |   |   | |         | | | |     | | |                 | | | |   | |   | |   |   | | | | |   |     |     | | | |   | |   | | | ",
" | | +---|---|-|-----------|---|-------|-------|---+ | |   |       |   +-----------------------|---|-------|---+ +---------------|-----+   | |   | |   |   | | | | |   |     |     | | | |   | |   | | | ",
" | | | | |   | | | | |     |   |     | |   | | | |   | |   |       |   |   |   |   | |         | | | |     | |   |               | | |     | |   | |   |   | | | | |   |     |     | | | |   | |   | | | ",
" | | | +---+ | +-|---|-+ +-----|-----|-+ +-+ | | |   | |   |       |   |   |   |   | |         | | | |     | |   |               | | |     | |   | |   |   | | | | |   |     |     | | | |   | |   | | | ",
" | | |   | | |   | | | | | |   |     |   |   | | |   | |   |       |   |   |   |   | |         | | | |     | |   |               | | |     | |   | |   |   | | | | |   |     |     | | | |   | |   | | | ",
" | | | +-|-----------|-|---|---+     | +-------|-+   | |   |       |   |   |   |   | |         +---|-+     | |   |               | | |   +-|-|-----|-----+ | | | | +---+     | +-+ | +-+ |   | |   | | | ",
" | | | | | | |   | | | | | |         | | |   | |     | |   |       |   |   |   |   | |           | |       | |   |               | | |   | | |   | |   | | | | | |           | | | |     |   | |   | | | ",
" | +-----|-|V------|-|---|-|---------|-|-------|-----|-----------------|-------------------------|---------|-----|---------------------------+   | |   | | +-|-+ |           | | | |     |   | |   | | | ",
" |   | | | | |   | | | | | |         | | |   | |     | |   |       |   |   |   |   | |           | |       | |   |               | | |   | |     | |   | |   |   |           | | | |     |   | |   | | | ",
" |   | +-|-|-----|-|-|-|---------------------|-|-------|---------------|---|-------|-------------|---------|-|-----------+       | | |   | |     | |   | |   |   |           | | | |     |   | |   | | | ",
" |   |   | | |   | | | | | |         | | |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |       | | |   | |     | |   | |   |   |           | | | |     |   | |   | | | ",
" |   | +-----+   | | | | | |         +---|-----------|-|---------------|-------|---|-|-----------------------|---|-----------------|-----|-------|-|---|-|---|---+           | | | |     |   | |   | | | ",
" |   | | | |     | | | | | |           | |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |       | | |   | |     | |   | |   |               | | | |     |   | |   | | | ",
" |   | +---------|-|---|-|-|-----------------|-|-------------------|-------|---|-------------------|---------|---------------------|-|-----|-------|---|-|---|-------------------|-|-----|---|-|-----+ | ",
" |   |   | |     | | | | | |           | |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |       | | |   | |     | |   | |   |               | | | |     |   | |   |   | ",
" | +-|-----|-----+ +---|---|-----------------|---+   | |   |       |   |   |   |   | |           | |       | |   +-----------+   | | |   | |     | |   | |   |               +-|---|-----|-----+   |   | ",
" | | |   | |         | | | |           | |   | | |   | |   |       |   |   |   |   | |           | |       | |           |   |   | | |   | |     | |   | |   |                 | | |     |   |     |   | ",
" +-|-|-----|---------|-|-+ |           +-----|-|-+   | |   |       |   |   |   |   | |           | |       | |   +-----------|---+ | |   | |     | |   | |   |                 | | |     |   |     |   | ",
"   | |   | |         | |   |             |   | |     | |   |       |   |   |   |   | |           | |       | |   |       |   |     | |   | |     | |   | |   |                 | | |     |   |     |   | ",
" +---------|---------|-|-----------------|-+ | |     | +---|-------|---|---|---|---------------+ | |       | |   |     +-|-------+ | |   | |     | |   | |   +---------------------|-+   |   +-----+   | ",
" | | |   | |         | |   |             | | | |     |     |       |   |   |   |   | |         | | |       | |   |     | |   |   | | |   | |     | |   | |                     | | | |   |             | ",
" | | | +---|---------+ +-+ |             | | | | +---------|---------------+   | +-|---------------|-------|-----|---------------|-|-----|-------|-------|---------------------|-|---+   |             | ",
" | | | | | |             | |             | | | | |   |     |       |   |       | | | |         | | |       | |   |     | |   |   | | |   | |     | |   | |                     | | |     |             | ",
" | | | | | |             | |             | | +---+   |     |   +---|-----------|---|-----------|-----------|-|---------|-|-----------|-----------|-|---|-|-------------------------|-----|-------------+ ",
" | | | | | |             | |             | |   |     |     |   |   |   |       | | | |         | | |       | |   |     | |   |   | | |   | |     | |   | |                     | | |     |               ",
" | | | | | |             | |     +-------|-|-+ |     |     |   |   |   |       | | | |         | | | +-----------|-----+ |   +---+ | |   | |     | |   | +---------------------+ +-------|-------+       ",
" | | | | | |             | |     |       | | | |     |     |   |   |   |       | | | |         | | | |     | |   |       |         | |   | |     | |   |                           |     |       |       ",
" | | | | | |         +-----|-----|-+     | | +-|-----------|---|-----------------|---+         | | | +-----+ |   +-------|-----------+   | |     | |   |             +-------------|-------------+       ",
" | | | | | |         |   | |     | |     | |   |     |     |   |   |   |       | | |           | | |         |           |         |     | |     | |   |             |             |     |               ",
" | | | | | |         |   | |     | |     | |   | +---------|---|---|---|-------|-|-|-----------|-|-|---------|-------------------+ | +---|-------------+             +-------------|-----+               ",
" | | | | | |         |   | |     | |     | |   | |   |     |   |   |   |       | | |           | | |         |           |       | | |   | |     | |                               |                     ",
" | | | | | |         |   | |     | +-----------|-----|-----------+ |   | +-----|-|-|-------------------------|-----------+     +-|-|-|-------------+                               |                     ",
" | | | | | |         |   | |     |       | |   | |   |     |   | | |   | |     | | |           | | |         |                 | | | |   | |     |                                 |                     ",
" | | +---------------------|-----|-------|-|---------|-----|-----------|-|-----|---|-+       +-------+       |                 +-|-|-+   | |     | +---------------------------------+                   ",
" | |   | | |         |   | |     |       | |   | |   |     |   | | |   | |     | | | |       | | | | |       |                   | |     | |     | |                               | |                   ",
" | |   +-|-|---------|---|-------|---------|---|-|---------------|-------|---------|---------|-|-|-|---------|---------------------|-------|---------+                             | |             +-+   ",
" | |     | |         |   | |     |       | |   | |   |     |   | | |   | |     | | | |       | | | | |       |                   | |     | |     | | |                             | |             | |   ",
" | |     | |         |   | |     +-------|-----|-----------|---|---|---+ |     | | | |       | +-+ +---------|---------------+   | |     | |     | | |                             | |             | |   ",
" | |     | |         |   | |             | |   | |   |     |   | | |     |     | | | |       |       |       |               |   | |     | |     | | |                             | |             | |   ",
" | | +---+ |         |   | |             | |   | |   |     |   | | |   +---------|-|-|-------|---------+     |               |   +---------|-----+ +-+                             | |             | |   ",
" | | |     |         |   | |             | |   | |   |     |   | | |   | |     | | | |       |       | |     |               |     |     | |                                       | |             | |   ",
" | | |     |         |   | |   +---------|-+   | |   |     |   | +-----+ |     +-----|-------+       +-+     +---------------+     |     | |                                       | |             | |   ",
" | | |     |         |   | |   |         |     | |   |     |   |   |     |       | | |                                             |     | |                                       | |             | |   ",
" | | |     |         |   | |   +---------|-------|---------|---|---|-----|-----------|---------------------------------------------|-------+   +-------------------------------------|---------------+   ",
" | | |     |         |   | |             |     | |   |     |   |   |     |       | | |                                             |     |     |                                   | |             |     ",
" | | |     +---------+   | +-------------|-----------|---------|---|-------------|-------------------------------------------------+     |     |                                   | |             |     ",
" | | |                   |               |     | |   |     |   |   |     |       | | |                                                   |     |                                   | |             |     ",
" | | |                   |     +---------+ +---------|---+ +---|---------+       +-+ +---------------------------------------------+     |     |                                   | |             |     ",
" | | |                   |     |           |   | |   |   |     |   |                                                               |     |     |                                   | |             |     ",
" +-+ +-------------------------|-----------+ +-+ +---|---+     |   +---------------------------------------------------------------+     +-----+                                   | +-------------+     ",
"                         |     |             |       |         |                                                                                                                   |                     ",
"                         +-----+             +-------+         +--------------------------------------------B----------------------------------------------------------------------+                     ",
"                                                                                                                                                                                                         "};
      
        
        int column = 0;
        int row = 1;
        int steps = 0;
        int direction = SOUTH; //starts moving down
        boolean finished = false;
        String seq = "";
        
        //SETTING STARTING POS
        char[] ar = lines[0].toCharArray();
        for(int t = 0; t < ar.length; t++){
            if(ar[t] == '|'){
                column = t;
                break;
            }
        }
        
        while(!finished)
        {
            char[] array = lines[row].toCharArray();
            if((array[column] >= 65 && array[column] <= 90) || array[column] == 45 || array[column] == 124)
            {
                //ADDING LETTERS TO STRING
                if(array[column] >= 65 && array[column] <= 90){
                    seq += array[column];
                }
                
                if(direction == NORTH){
                    row -= 1;
                }
                else if(direction == SOUTH){
                    row += 1;
                }
                else if(direction == WEST){
                    column -= 1;
                }
                else if(direction == EAST){
                    column += 1;
                }
            }
            else if(array[column] == 43)//IF IT IS A PLUS SIGN
            {
                if(direction == NORTH || direction == SOUTH)
                {
                    char left = array[column-1];
                    char right = array[column+1];
                    if((left >= 65 && left <= 90) || left == 45){
                        direction = WEST;
                        column -= 1;
                    }
                    else if((right >= 65 && right <= 90) || right == 45){
                        direction = EAST;
                        column += 1;
                    }
                }
                else if(direction == WEST || direction == EAST)
                {
                    if(row != lines.length-1){
                        char up = lines[row-1].charAt(column);
                        char down = lines[row+1].charAt(column);
                        if((up >= 65 && up <= 90) || up == 124){
                            direction = NORTH;
                            row -= 1;
                        }
                        else if((down >= 65 && down <= 90) || down == 124){
                            direction = SOUTH;
                            row += 1;
                        }
                    }
                    else{
                        direction = NORTH;
                        row -= 1;
                    }
                }
            }
            else if(array[column] == ' '){
                finished = true;
                //System.out.println(seq);  PART 1
                System.out.println(steps+1);
            }
            
            System.out.println(array[column]);
            steps += 1;
        }
    }
}
